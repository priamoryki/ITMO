/*
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣴⣶⣿⣿⢿⣷⣶⣶⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⡿⣻⠟⣩⣷⣿⣿⣿⣿⣿⣿⣿⣿⣦⡀⠀⢰⠷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣿⣟⡁⠁⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⡃⣸⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⣿⣿⣿⣿⣾⣿⡿⣿⠿⠛⠿⢿⣿⣿⣿⣿⣿⣿⢿⣷⡷⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⣿⣿⣿⣿⡟⠉⠉⠀⠀⠀⠀⠀⠀⠀⠈⠛⢿⣿⣿⣧⣤⣼⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⣿⣿⣿⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣿⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⣷⣿⣿⡟⣀⣤⠶⠿⠆⠀⠀⠀⠘⠛⠛⠛⠳⣦⣸⣿⣿⣿⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⣿⣿⣿⠛⠋⠀⣤⣤⣄⠀⠀⠀⢀⣴⣶⣤⣠⡌⢹⣿⣿⣿⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣽⣿⣿⢤⣴⡿⢛⢿⡿⠁⠀⠀⠘⢿⣟⣽⡻⢷⣞⣿⣿⣿⣿⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⣿⣿⣿⣿⣯⠉⣄⠿⢇⡶⠀⠀⠀⠀⠛⠘⠛⣥⠚⣭⣿⣿⣿⣿⣿⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⣿⣿⣿⣿⣿⡿⣇⢸⡟⠛⠀⠀⢸⢠⠀⠀⠀⣚⣨⣰⣿⣿⣿⡿⣿⣿⣿⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⢻⣿⣿⡿⡟⠛⠛⠛⠛⠛⠛⠃⠀⠘⡉⡏⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⣿⣿⢸⣿⣿⣿⣷⣶⡶⡶⠶⠶⠶⠿⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⡄⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⣠⣾⣿⣿⡿⣿⣿⣿⣿⣿⣼⣿⣿⣿⣿⣿⢿⡟⠲⣦⣤⡶⠚⢙⡿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠙⣿⣿⣿⣦⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⣿⣿⣿⡟⢁⣿⣿⣿⣿⣿⢻⣿⣿⣿⢿⣯⣎⢷⡄⠀⠀⢀⣴⠟⣱⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⢹⣿⣿⡿⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⢸⣿⣿⡇⣸⣿⣿⣿⣿⣿⣾⣿⡟⠁⡼⢻⢻⡄⠻⣆⣰⠟⠁⣰⣿⣿⣿⣿⣿⠛⠻⢿⣿⣿⣿⣾⣿⣿⡇⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⢸⣿⣿⣷⣿⣿⣿⡿⠉⣼⣿⠏⠀⢠⣥⠃⠀⠻⣤⠞⠁⢀⣼⡿⢄⣸⣿⣿⣿⡄⠀⠀⠉⠻⣿⣿⣿⡿⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⢸⣿⣿⣿⣿⣿⡟⠁⣼⣿⣿⠇⠀⣬⡇⣠⠞⢦⣽⣦⣠⢯⡍⣮⢣⡈⢿⣿⣿⣧⢸⣿⠀⠀⣿⣿⣿⣷⣦⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⢠⣾⣿⣿⣿⣿⣿⣆⣼⣿⣿⣿⠀⢠⣿⡞⠁⠀⢀⣈⡟⠁⣶⠁⢋⠀⢱⣤⢻⣿⣿⣞⣿⠀⢸⣿⣿⣿⣿⣿⣧⡀⠀⠀⠀⠀
⠀⠀⢀⣴⣿⣿⣿⣿⣿⣿⢡⣿⣿⡿⣼⡇⠀⢸⣯⠴⠆⢛⣽⡿⠶⠘⢷⡄⠸⠇⢰⢱⡎⢿⣿⣿⣯⠀⠈⣿⣿⣿⣿⣿⣿⣿⣦⡀⠀⠀
⢀⣴⣿⣿⡟⢹⣿⣿⣿⣿⣿⣿⣿⠇⣿⠀⠀⣿⣌⢁⡶⠯⠑⠢⠄⣀⡀⠹⣆⡆⡆⣸⡇⠈⣿⣿⣿⣷⡀⢹⣿⣿⣿⣿⣿⣿⣿⣷⣄⠀
⢸⣿⣿⣿⡇⢸⣿⣿⣿⣿⣿⣿⣿⣦⡇⠀⢀⣉⠾⣯⣤⣬⡷⢦⣤⣬⣩⣿⣾⣿⣾⣽⡇⠀⠘⣿⣿⣿⣿⡃⢻⣿⣿⣿⡇⢻⣿⣿⣿⡇
⢸⡿⣿⣿⣡⣾⣿⣿⠃⣿⢻⣿⣿⢻⡇⠀⢸⣧⣴⣶⣶⣶⣶⣾⣷⣶⣿⣾⣧⣴⣶⣶⣶⠀⠀⢹⣿⣿⡿⠀⢸⣿⣿⣿⡇⠀⣿⣿⣿⡇
⠈⠃⣨⣿⣿⣿⡿⠃⠀⣿⣸⣿⣿⡶⠀⠀⠈⠉⢹⣿⣿⣿⣿⣿⣿⠙⠛⠛⠛⠛⢻⣿⣿⠀⠀⢸⣿⣿⡇⠀⢨⠛⢿⣿⣇⠀⣿⣿⣿⠇
⠀⠛⠛⠻⠿⠾⠥⠤⠄⠿⢿⣿⣿⣦⣤⣤⣿⣄⣾⣿⣿⣿⣿⣿⣿⢀⣀⣀⣀⣠⣼⣿⣿⣤⣤⣼⠿⠿⠥⠤⠾⠤⠬⠛⠛⠓⠛⠛⠉⠀
*/

#include <bits/stdc++.h>
using namespace std;

int n, m;
vector<long long> a;
vector<pair<long long, int>> tree, result;
 
void mySet(int i, int v) {
    long long x = n + i - 1;
    tree[x] = pair<long long, int>(v, 1);
    x = (x + 1) / 2 - 1;
    while (x >= 0) {
        if (tree[2 * x + 1].first > tree[2 * x + 2].first) {
            tree[x] = pair<long long, int>(tree[2 * x + 2].first, tree[2 * x + 2].second);
        } else if (tree[2 * x + 1].first == tree[2 * x + 2].first) {
            tree[x] = pair<long long, int>(tree[2 * x + 1].first, tree[2 * x + 1].second + tree[2 * x + 2].second);
        } else {
            tree[x] = pair<long long, int>(tree[2 * x + 1].first, tree[2 * x + 1].second);
        }
        x = (x + 1) / 2 - 1;
    }
}

pair<long long, int> myMin(int l, int r) {
    long long result = LONG_LONG_MAX;
    int counter = 0;
    l += n - 1;
    r += n - 2;
    while (r >= l) {
        if (l % 2 == 0){
            if (result > tree[l].first) {
                counter = tree[l].second;
                result = tree[l].first;
            } else if (result == tree[l].first) {
                counter += tree[l].second;
                result = tree[l].first;
            }
        }
        l = l / 2;
        if (r % 2 == 1) {
            if (result > tree[r].first) {
                counter = tree[r].second;
                result = tree[r].first;
            } else if (result == tree[r].first) {
                counter += tree[r].second;
                result = tree[r].first;
            }
        }
        r = r / 2 - 1;
    }
    return pair<long long, int>(result, counter);
}

int main() {
    int s = 0;
    cin >> n >> m;
    a.resize(n);
    tree.resize(2 * n - 1);
    result.resize(m);
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }
    for (int i = 0; i < n; i++) {
        tree[n + i - 1] = pair<long long, int>(a[i], 1);
    }
    for (int i = n - 2; i >= 0; i--) {
        if (tree[2 * i + 1].first > tree[2 * i + 2].first) {
            tree[i] = pair<long long, int>(tree[2 * i + 2].first, tree[2 * i + 2].second);
        } else if (tree[2 * i + 1].first == tree[2 * i + 2].first) {
            tree[i] = pair<long long, int>(tree[2 * i + 1].first, tree[2 * i + 1].second + tree[2 * i + 2].second);
        } else {
            tree[i] = pair<long long, int>(tree[2 * i + 1].first, tree[2 * i + 1].second);
        }
    }
    for (int i = 0; i < m; i++) {
        int x, y, z;
        cin >> x >> y >> z;
        if (x == 1) {
            mySet(y, z);
        } else if (x == 2) {
            result[s++] = myMin(y, z);
        }
    }
    for (int i = 0; i < s; i++) {
        cout << result[i].first << " " << result[i].second << "\n";
    }
}